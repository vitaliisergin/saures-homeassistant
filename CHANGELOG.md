# Changelog

Все значимые изменения в проекте будут документироваться в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [1.0] - 2025-11-09

### Добавлено

- Полнофункциональная интеграция для Home Assistant
- Мониторинг показаний счётчиков холодной и горячей воды в реальном времени
- Диагностика контроллеров (заряд батареи, уровень сигнала RSSI, состояние связи)
- Автоматический импорт исторических данных за последние 7 дней при первой настройке
- Ежедневное обновление статистики (раз в 24 часа)
- Поддержка Home Assistant 2025.10+ с новыми требованиями к API статистики (`unit_class`, `mean_type`)
- Настраиваемый интервал обновления (60-1440 минут, по умолчанию 60 минут)
- LRU-кеширование для снижения нагрузки на API
- Автоматическое управление SID (session ID) согласно документации Saures API
- Защита от rate limiting с задержками между запросами (500ms)
- Обработка всех типов ошибок API (`WrongSIDException`, `DuplicateRequestException`)
- Совместимость с Energy Dashboard
- Поддержка HACS для упрощённой установки
- Comprehensive README на русском языке
- Сенсоры для каждого контроллера:
  - Показания счётчиков воды
  - Время последнего подключения
  - Время последнего запроса данных
  - Время последнего снятия показаний
  - Статус API (healthy/warning/critical)

### Технические детали

- Реализация официального Saures API v1.0
- Минимальный интервал обновления 60 минут для предотвращения блокировки IP
- TTL кеша оптимизирован под интервал обновления (55 минут)
- Автоматический retry при временных ошибках
- Экспоненциальная задержка при повторных попытках (2-60 секунд)
- Правильное форматирование `statistic_id` для внешних статистик
- Округление временных меток до начала часа (требование HA)
- Поддержка multiple controllers и meters

### Безопасность

- Соблюдение всех рекомендаций Saures API для предотвращения блокировок
- Не выполняется переавторизация перед каждым запросом
- Частота запросов не превышает скорость обновления данных в системе
- Защита от `DuplicateRequestException`

## [Unreleased]

Планы на будущие версии:
- Поддержка дополнительных типов датчиков (температура, давление)
- Уведомления о критических событиях (протечки, отсутствие связи)
- Интеграция с системами автоматизации (автоматическое перекрытие кранов)
- Поддержка нескольких аккаунтов Saures

